<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Reading Journal ‚Ä¢ Bingo</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#1c1c2b">

<link rel="manifest" href="manifest.json">
<!-- Manifest PWA -->
<link rel="manifest" href="manifest.json">

<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Reading Journal">

<!-- √çcones para iOS -->
<link rel="apple-touch-icon" href="icons/icon-192.png">

<!-- Splash screens iOS -->
<link rel="apple-touch-startup-image" href="screenshots/splash-640x1136.png" media="(device-width: 320px) and (device-height: 568px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-750x1334.png" media="(device-width: 375px) and (device-height: 667px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-1242x2208.png" media="(device-width: 414px) and (device-height: 736px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-1536x2048.png" media="(device-width: 768px) and (device-height: 1024px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-1668x2224.png" media="(device-width: 834px) and (device-height: 1112px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-1668x2388.png" media="(device-width: 834px) and (device-height: 1194px)">
<link rel="apple-touch-startup-image" href="screenshots/splash-2048x2732.png" media="(device-width: 1024px) and (device-height: 1366px)">

<style>
* { box-sizing: border-box; }

html, body {
  margin: 0;
  width: 100%;
  min-height: 100vh;
}

@media (max-width: 600px) {
  .navbar {
    justify-content: space-between;
    padding: 0 12px;
    overflow-x: auto;
  white-space: nowrap;
  }

  .nav-link {
    font-size: .85rem;
    padding: 6px 10px;
  }
}
.navbar {
  position: fixed;
  top: 0;
  width: 100%;
  height: 64px;
  background: rgba(15, 15, 20, 0.92);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: space-around;
  align-items: center;
  z-index: 1000;
  box-shadow: 0 4px 12px rgba(0,0,0,.4);
}

body {
  margin: 0;
  color: #fff;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: clamp(14px, 2vw, 16px);
  background:
    linear-gradient(rgba(32, 32, 117, 0.75), rgba(135, 135, 199, 0.75)),
    url("https://img.myloview.com.br/fotomurais/esboce-o-teste-padrao-ou-o-fundo-sem-emenda-dos-livros-do-vintage-esboco-livro-sem-emenda-de-educacao-para-escola-literatura-e-apple-ilustracao-700-149614705.jpg")
    no-repeat center / cover;
}

html, body {
  width: 100%;
  min-height: 100vh;
}


/* LINKS */
.nav-link {
  color: #aaa;
  text-decoration: none;
  font-size: .95rem;
  padding: 8px 14px;
  border-radius: 8px;
  transition: all .25s ease;
  position: relative;
   flex-shrink: 0;
}

.navbar::-webkit-scrollbar {
  display: none;
}

/* HOVER */
.nav-link:hover {
  color: #fff;
  background: rgba(255,255,255,.08);
}

/* LINK ATIVO */
.nav-link.active {
  color: #fff;
  font-weight: 600;
  background: rgba(255,255,255,.12);
}

/* LINHA ATIVA EMBAIXO */
.nav-link.active::after {
  content: "";
  position: absolute;
  bottom: -6px;
  left: 50%;
  width: 18px;
  height: 3px;
  background: #7c7cff;
  border-radius: 3px;
  transform: translateX(-50%);
}


@media (max-width:600px){
  .navbar{overflow-x:auto;white-space:nowrap}
}

/* CONTAINER */
.container {
  padding-top: 90px;
  max-width: 900px;
  margin: auto;
  padding-inline: 16px;
}

h1 { text-align: center; }

/* CONTROLS */
.bingo-controls {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: center;
}

.bingo-controls input,
.bingo-controls select,
.bingo-controls button {
  padding: 10px 14px;
  border-radius: 10px;
  border: none;
  font-size: 1rem;
}

.bingo-controls button {
  background: linear-gradient(135deg,#7c7cff,#c83bff);
  color: #fff;
  cursor: pointer;
}

/* BINGO */
.bingo {
  margin: 40px 0;
  background: rgba(0,0,0,.25);
  padding: 16px;
  border-radius: 16px;
}

.bingo h2 {
  text-align: center;
}

.bingo-actions {
  display: flex;
  justify-content: center;
  margin-bottom: 10px;
}

.delete-btn {
  background: #ff5c5c;
  border: none;
  color: #fff;
  padding: 6px 14px;
  border-radius: 12px;
  cursor: pointer;
}

.color-picker {
  display: flex;
  justify-content: center;
  gap: 8px;
  margin: 10px 0;
}

.color-picker div {
  width: 26px;
  height: 26px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid #fff3;
}

.progress-box {
  max-width: 500px;
  margin: 10px auto;
}

.progress-text {
  text-align: center;
  font-size: .9rem;
  margin-bottom: 6px;
}

.progress-bar {
  width: 100%;
  height: 12px;
  background: #1e1e2e;
  border-radius: 10px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg,#7c7cff,#c83bff);
  transition: width .3s ease;
}

.bingo-grid {
  display: grid;
  gap: 10px;
  max-width: 500px;
  margin: 20px auto;
}

.bingo-cell {
  aspect-ratio: 1/1;
  background: #2a2a3a;
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6px;
  cursor: pointer;
}

.bingo-cell.done {
  color: #000;
  font-weight: bold;
}

.bingo-cell textarea {
  width: 100%;
  height: 100%;
  background: transparent;
  border: none;
  resize: none;
  color: inherit;
  text-align: center;
  outline: none;
}

/* TOAST */
.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: #222;
  padding: 12px 18px;
  border-radius: 20px;
  opacity: 0;
  pointer-events: none;
  transition: .3s;
}

.toast.show { opacity: 1; }

.bingo-cell {
  position: relative;
}

.bingo-cell::after {
  content: "‚úì";
  position: absolute;
  font-size: 2.2rem;
  font-weight: bold;
  color: #000;
  opacity: 0;
  transform: scale(0.6);
  transition: .2s ease;
}

.bingo-cell.done::after {
  opacity: 1;
  transform: scale(1);
}

.alphabet-grid {
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 20px;
}

</style>
</head>

<body>

<nav class="navbar">
  <a href="livros.html" class="nav-link">Livros</a>
  <a href="challenge.html" class="nav-link">Challenge</a>
  <a href="calendario.html" class="nav-link">Calend√°rio</a>
  <a href="bingo.html" class="nav-link active">Bingo</a>
  <a href="cores.html" class="nav-link">Cores</a>
  <a href="favoritos.html" class="nav-link">Favoritos</a>
  <a href="a-z.html" class="nav-link">A-Z</a>
</nav>

<div class="container">
  <h1>üéØ Bingo Liter√°rio</h1>

  <div class="bingo-controls">
    <input id="title" placeholder="T√≠tulo do Bingo">
    <select id="size">
      <option value="3">3x3</option>
      <option value="4">4x4</option>
      <option value="5">5x5</option>
    </select>
    <button onclick="addBingo()">Criar</button>
  </div>

  <div id="bingos"></div>
</div>

<div class="toast" id="toast"></div>

<script>
const STORAGE="reading-bingos";
let bingos=JSON.parse(localStorage.getItem(STORAGE))||[];
const colors=["#f5a3c7","#7c7cff","#8ef5b5","#ffd36e","#ff9b9b"];
const bingosDiv=document.getElementById("bingos");

function toast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),2000);
}

function notify(title,body){
  if(!("Notification"in window))return;
  if(Notification.permission==="granted"){
    new Notification(title,{body});
  }else if(Notification.permission!=="denied"){
    Notification.requestPermission().then(p=>{
      if(p==="granted")new Notification(title,{body});
    });
  }
}

function save(){ localStorage.setItem(STORAGE,JSON.stringify(bingos)); }

function addBingo(){
  bingos.push({
    id:Date.now(),
    title:title.value||"Bingo sem t√≠tulo",
    size:+size.value,
    color:colors[0],
    completed:false,
    cells:Array.from({length:size.value**2},()=>({text:"",done:false}))
  });
  save(); render(); title.value="";
  toast("üéâ Bingo criado!");
}

function removeBingo(id){
  bingos = bingos.filter(b => b.id !== id);
  save();
  render();
  toast("üóëÔ∏è Bingo exclu√≠do");
}


function toggle(id,i){
  const b=bingos.find(x=>x.id===id);
  b.cells[i].done=!b.cells[i].done;

  const done=b.cells.filter(c=>c.done).length;
  const total=b.cells.length;

  if(done===total && !b.completed){
    b.completed=true;
    toast("üèÜ Bingo completo!");
    notify("üèÜ Bingo conclu√≠do!",`Voc√™ completou "${b.title}"`);
  }

  if(done<total) b.completed=false;

  save();
  render();
}


function edit(id,i,v){
  bingos.find(x=>x.id===id).cells[i].text=v;
  save();
}

function setColor(id,c){
  bingos.find(x=>x.id===id).color=c;
  save(); render();
}

function render(){
  bingosDiv.innerHTML="";
  bingos.forEach(b=>{
    const done=b.cells.filter(c=>c.done).length;
    const total=b.cells.length;
    const percent=Math.round((done/total)*100);

    const div=document.createElement("div");
    div.className="bingo";
    div.innerHTML=`
      <h2>${b.title} ${b.completed?"üèÜ":""}</h2>

      <div class="bingo-actions">
        <button class="delete-btn" onclick="removeBingo(${b.id})">Excluir</button>
      </div>

      <div class="progress-box">
        <div class="progress-text">${done}/${total} (${percent}%)</div>
        <div class="progress-bar">
          <div class="progress-fill" style="width:${percent}%"></div>
        </div>
      </div>

      <div class="color-picker">
        ${colors.map(c=>`
          <div style="background:${c}" onclick="setColor(${b.id},'${c}')"></div>
        `).join("")}
      </div>

      <div class="bingo-grid" style="grid-template-columns:repeat(${b.size},1fr)">
        ${b.cells.map((c,i)=>`
          <div class="bingo-cell ${c.done?"done":""}" style="background:${c.done?b.color:"#2a2a3a"}">
            <textarea
                onclick="event.stopPropagation()"
                onmousedown="event.stopPropagation()"
                ontouchstart="event.stopPropagation()"
                oninput="edit(${b.id},${i},this.value)"
                >${c.text}</textarea>
          </div>
        `).join("")}
      </div>
    `;
    bingosDiv.appendChild(div);

    // **Adiciona o duplo toque para todas as c√©lulas**
    const cells = div.querySelectorAll(".bingo-cell");
    cells.forEach((cell, i) => {
      let lastTap = 0;
      cell.addEventListener("touchend", (e) => {
        const currentTime = new Date().getTime();
        const tapLength = currentTime - lastTap;
        if (tapLength < 300 && tapLength > 0) {
          toggle(b.id, i); // marca/desmarca a c√©lula
          e.preventDefault();
        }
        lastTap = currentTime;
      });
    });
  });
}



const paginaAtual = location.pathname.split("/").pop();

document.querySelectorAll(".nav-link").forEach(link => {
  const href = link.getAttribute("href");
  link.classList.toggle("active", href === paginaAtual);
});


render();

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
